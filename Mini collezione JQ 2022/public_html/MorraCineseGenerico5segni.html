<!DOCTYPE html>
<html>
    <head>
	<title>Morra cinese con Lizard & Spock</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<script src="https://code.jquery.com/jquery-3.4.0.min.js" type="text/javascript"></script>
	
	
	<script type="text/javascript">
	    $(function()
	    {
		// Stando a https://www.html.it/articoli/javascript-var-let-e-const/ dichiarando con let le variabili si comportano
		// in modo simile agli altri linguaggi in quanto hanno lo scope; var invece √® globale alla pagina.
		let tentativi = 0,MaxTentativi=5;
		let giocatore, computer;
		let puntiC = 0, puntiG = 0;
		
		// Segno nel primo elemento quello che batte il secondo
		// Per essere equilibrato il gioco ogni segno deve avere tante entrate quante uscite
		// e disponendo i segni su un poligono come nelle immagini, devono essere disegnate tutte le diagonali e i lati
		// In questo modo si gestiscono anche i pareggi
		const diagramma=[
			    ["Spock","Forbice"],
			    ["Spock","Sasso"],
			    ["Forbice","Lucertola"],
			    ["Forbice","Carta"],
			    ["Carta","Spock"],
			    ["Carta","Sasso"],
			    ["Sasso","Forbice"],
			    ["Sasso","Lucertola"],
			    ["Lucertola","Spock"],
			    ["Lucertola","Carta"]
				];
		console.log(diagramma);
		class cDiagramma
		{
		    constructor(a,b)
		    {
			this.Vincente=a;
			this.Perdente=b;
		    }
		}
		
		const Conversore=(coppia) => { return new cDiagramma(coppia[0],coppia[1]);}
		let oDiagramma=diagramma.map(Conversore);
		console.log(oDiagramma.map(JSON.stringify));



		
		// Assegno le etichette ai pulsanti
		$("[name=CmdGioca]").each(function()
		{
		    //alert($(this).attr("class"));
		    $(this).next().next().text($(this).attr("class").substring(6));
		});
		
		$("[name=CmdGioca]").click(function ()
		{		    
		    if(tentativi==MaxTentativi)return; // La partita √® terminata
		    giocatore=($(this).attr("class")).substring(6); // Il pulsante premuto dal giocatore
		    //alert(giocatore);
		    
		    var PossibiliGiocate="PrendiSpock,PrendiLucertola,PrendiSasso,PrendiForbice,PrendiCarta";
		    const vet = PossibiliGiocate.split(",");
		    computer=vet[Math.floor(Math.random() * vet.length)];
		    
		    $("#MossaPC").html("<img class="+computer+">");
		    computer=computer.substring(6);
		    
		    
		    
		    tentativi++;
		    
		    console.log(giocatore,computer);
		    const vincente = (giocata) => { return giocata.Vincente==giocatore && giocata.Perdente==computer;}
		    const perdente = (giocata) => { return giocata.Vincente==computer && giocata.Perdente==giocatore;}
		    
		    let vittoria = oDiagramma.filter(vincente); // Se trova 1 allora c' √®
		    let sconfitta = oDiagramma.filter(perdente);
		    
		    console.log(vittoria);
		    console.log(sconfitta);
		    
		    if(vittoria.length==1)
		    {
			$("#esito").text("Hai fatto un punto");
			puntiG++;
		    }
		    else if(sconfitta.length==1)
		    {
			$("#esito").text("Il computer ha fatto un punto");
			puntiC++;
		    }
		    else
		    {
			$("#esito").text("Parit√†");
		    }
		    
		    AggiornaValori();
		    
		    if(tentativi==MaxTentativi)
		    {
			if(puntiC==puntiG)$("#finale").text("Parit√†");
			else if(puntiC>puntiG)$("#finale").text("Hai perso!");
			else $("#finale").text("Hai vinto!");
		    }
		});

		
		function AggiornaValori()
		{
		    $("#tentativoVal").text(tentativi+" di "+MaxTentativi);
		    $("#puntiPC").text(puntiC);
		    $("#puntiUmano").text(puntiG);
		}
		

	    });
	</script>
	
	
	<link rel="stylesheet" href="Pulsanti.css"/>
	<link rel="stylesheet" href="MorraCinese.css"/>
    </head>
    <body>
	Mi chiedo come gli sia venuto in mente di inserire un personaggio di Star Trek e uno dell' Uomo Ragno.
	
	<!-- Metto un' immagine a sinsitra e una a destra per riempire la pagina. Una incorporata (e pesantemente da modificare e molte cose si possono omettere), l' altra linkata. -->
	<img src='morra/Pierre_ciseaux_feuille_l√©zard_spock_aligned.svg' id='StaticaSx'>
	<svg version="1.1" id="StaticaDx"  viewBox="0 0 400 365">
	    <g>
		<text transform="matrix(1 0 0 1 171.5247 44.95)" fill="#00D0F1" font-family="'Helvetica'" font-size="20">Forbici</text>
		<text transform="matrix(1 0 0 1 330.2561 155.45)" fill="#FFB300" font-family="'Helvetica'" font-size="20">Carta</text>
		<text transform="matrix(1 0 0 1 271.6282 334.45)" fill="#5100F1" font-family="'Helvetica'" font-size="20">Sasso</text>
		<text transform="matrix(1 0 0 1 69.3157 334.45)" fill="#51C651" font-family="'Helvetica'" font-size="20">Lizard</text>
		<text transform="matrix(1 0 0 1 22.4114 155.45)" fill="#F13551" font-family="'Helvetica'" font-size="20">Spock</text>
		<path id="path3201" color-interpolation="linearRGB" fill="none" stroke="#F13551" stroke-width="1.75" d="M80.5,126.5l87.75-63.75   "/>
		<path id="path3983" color-interpolation="linearRGB" fill="none" stroke="#00D0F1" stroke-width="1.75" d="M232,63l87.25,63.5"/>
		<path id="path4500" color-interpolation="linearRGB" fill="none" stroke="#FFB300" stroke-width="1.75" d="M340,187.75L306,292"/>
		<path id="path6047" color-interpolation="linearRGB" fill="none" stroke="#5100F1" stroke-width="1.75" d="M253.25,329.25H144"/>
		<path id="path6564" color-interpolation="linearRGB" fill="none" stroke="#51C651" stroke-width="1.75" d="M96.912,303.47   L58.75,184.625"/>
		<path id="path7081" color-interpolation="linearRGB" fill="none" stroke="#00D0F1" stroke-width="1.75" d="M187.03,77.913   l-69.442,215.134"/>
		<path id="path7598" color-interpolation="linearRGB" fill="none" stroke="#51C651" stroke-width="1.75" d="M137.532,306.308   L321.32,173.433"/>
		<path id="path8115" color-interpolation="linearRGB" fill="none" stroke="#FFB300" stroke-width="1.75" d="M311.481,150.391H86.62"/>
		<path id="path8632" color-interpolation="linearRGB" fill="none" stroke="#F13551" stroke-width="1.75" d="M78.135,172.665   l183.787,133.937"/>
		<path id="path9149" color-interpolation="linearRGB" fill="none" stroke="#5100F1" stroke-width="1.75" d="M281.782,290.752   L212,76.559"/>

		<text transform="matrix(0.3213 0.947 -0.947 0.3213 231.6086 172.7649)" fill="#5100F1" font-family="'Helvetica-Bold'" font-size="12">rompe</text>
		<text transform="matrix(1 0 0 1 182.1165 341.7498)" fill="#5100F1" font-family="'Helvetica-Bold'" font-size="12">schiaccia</text>
		<text transform="matrix(0.8172 -0.5763 0.5763 0.8172 209.7102 248.8455)" fill="#51C651" font-family="'Helvetica-Bold'" font-size="12">mangia</text>
		<text transform="matrix(0.3129 0.9498 -0.9498 0.3129 60.7327 229.1316)" fill="#51C651" font-family="'Helvetica-Bold'" font-size="12">avvelena</text>
		<text transform="matrix(1 0 0 1 182.158 163.4998)" fill="#FFB300" font-family="'Helvetica-Bold'" font-size="12">smentisce</text>
		<text transform="matrix(0.3075 -0.9515 0.9515 0.3075 329.0911 257.1111)" fill="#FFB300" font-family="'Helvetica-Bold'" font-size="12">avvolge</text>
		<text transform="matrix(0.8117 0.5841 -0.5841 0.8117 255.8694 75.0681)" fill="#00D0F1" font-family="'Helvetica-Bold'" font-size="12">taglia</text>
		<text transform="matrix(0.8055 0.5926 -0.5926 0.8055 155.1077 222.7849)" fill="#F13551" font-family="'Helvetica-Bold'" font-size="12">vaporizza</text>
		<text transform="matrix(0.8184 -0.5747 0.5747 0.8184 96.4124 108.2439)" fill="#F13551" font-family="'Helvetica-Bold'" font-size="12">rompe</text>
		<text transform="matrix(0.3123 -0.95 0.95 0.3123 155.0364 217.4294)" fill="#00D0F1" font-family="'Helvetica-Bold'" font-size="12">decapitano</text>
		<path id="path13255" color-interpolation="linearRGB" fill="none" stroke="#F13551" stroke-width="1.25" d="M139.75,72.625   L169.625,62l-19.5,24.875"/>
		<path id="path13257" color-interpolation="linearRGB" fill="none" stroke="#5100F1" stroke-width="1.25" d="M212.25,106.375   l-1-31.75l17.5,26"/>
		<path id="path13259" color-interpolation="linearRGB" fill="none" stroke="#00D0F1" stroke-width="1.25" d="M302.125,103.375   l19.75,25l-29.875-11"/>
		<path id="path13261" color-interpolation="linearRGB" fill="none" stroke="#51C651" stroke-width="1.25" d="M293.125,183.375   l29.5-10.625L303,197.625"/>
		<path id="path13265" color-interpolation="linearRGB" fill="none" stroke="#FFB300" stroke-width="1.25" d="M323.25,267.5   l-17.75,26.625l1.25-32"/>
		<path id="path13267" color-interpolation="linearRGB" fill="none" stroke="#F13551" stroke-width="1.25" d="M243.75,282.125   L263.5,307.5l-29.875-11"/>
		<path id="path13269" color-interpolation="linearRGB" fill="none" stroke="#5100F1" stroke-width="1.25" d="M172.25,338.125   L172.25,338.125l-30.5-8.875l30.75-8.625"/>
		<path id="path13271" color-interpolation="linearRGB" fill="none" stroke="#00D0F1" stroke-width="1.25" d="M134.75,267.875   L134.75,267.875L117.125,294.5l1-32"/>
		<path id="path13273" color-interpolation="linearRGB" fill="none" stroke="#51C651" stroke-width="1.25" d="M59.25,214.625l-1-32   l17.5,26.5"/>
		<path id="path13275" color-interpolation="linearRGB" fill="none" stroke="#FFB300" stroke-width="1.25" d="M114.875,159.125   L84.5,150.5l30.625-8.875"/>
	    </g>
	</svg>
	
	
	
	
	<table width="100%"><tr>
	    <td width="50%"><h1>üñ•Ô∏è <span id="puntiPC">0</span></h1></td>
	    <td width="50%" align="right"><h1><span id="puntiUmano">0</span> üßíüèº</h1></td>
	</tr></table>
	
	
	<center>
	    <h1>Tentativo <span id="tentativoVal">...</span></h1>
	    Scegli
	</center>
	<table align="center"><tr>
	    <!-- Avrebbe pi√π senso invertire i nomi con le classi, ma comunque ogni pulsante ha immagine diversa -->
	    <!-- L' allineamento della tabella agisce sulla tabella stessa, quello dei TD sul contenuto -->
	    <td align="center"><button name="CmdGioca" class='PrendiSpock'></button><br><span class="bianco"></span></td>
	    <td align="center"><button name="CmdGioca" class='PrendiLucertola' ></button><br><span class="bianco"></span></td>
	    <td align="center"><button name="CmdGioca" class='PrendiSasso' ></button><br><span class="bianco"></span></td>
	    <td align="center"><button name="CmdGioca" class='PrendiForbice' ></button><br><span class="bianco"></span></td>
	    <td align="center"><button name="CmdGioca" class='PrendiCarta' ></button><br><span class="bianco"></span></td>
	</tr></table>
    
    
	
	<center><h3>Mossa del computer</h3></center>
	<center><h1 id="MossaPC"></h1></center>
	<center><h2 id="esito"></h2></center>
	<center><h1 id="finale"></h1></center>
	<!<!-- Anche se credo questo venga comunque intercettato, non dovrebbe creare problemi in quanto cambier√† pagina -->
	<center><a href='Index.html'><button class="button-73">Elenco giochi</button></a></center>
	<center>Leggi la console per lo storico delle mosse</center>
    </body>
</html>
